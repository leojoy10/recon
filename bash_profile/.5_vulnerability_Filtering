#Vulnerability Filtering[3] --------------------------------------------------------



vulnerability-Filtering(){

#---------------------------
#Vulnerability Filtering:

#--------------
#XSS Filter

#1------------------------------------------------------------
#Filter URL using GF Pattern and kxss (xss.txt) :

cat urls.txt | gf xss | tee gf_xss.txt 
cat urls.txt | kxss | sed 's/=.*/=/' | sed 's/URL: //' | tee kxss.txt

cat gf_xss.txt kxss.txt | sort -u > xss.txt ; rm gf_xss.txt kxss.txt


#2-------------------------------------------------------------------------
#Find hidden GET parameters in javascript files (JS_xss.txt) :

#Crawl Link from GAU + Find Js files + in JS files find variables + append it to domain

#Single target
echo "enter the domain (target.com) "
read domain
echo $domain | gau | egrep -v '(.css|.png|.jpeg|.jpg|.svg|.gif|.wolf)' | while read url; do vars=$(curl -s $url | grep -Eo "var [a-zA-Z0-9]+" | sed -e 's,'var','"$url"?',g' -e 's/ //g' | grep -v '.js' | sed 's/.*/&=xss/g'); echo -e "\e[1;33m$url\n\e[1;32m$vars";done >JS_xss.txt 






#---------------
#SQLi Filter

#1----------------------------------------------
#Filter URL using GF Pattern (sql.txt) :

cat urls.txt | gf sqli | tee sql.txt

}



#Vulnerability Filtering[3] --------------------------------------------------------
